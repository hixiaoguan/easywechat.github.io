<!DOCTYPE html>
<html lang="zh-cn">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>卡券 | Easy We Chat</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="http://easywechat.org/zh-cn/docs/card.html">
  <!-- Alternative links -->
  
    
      <link rel="alternative" hreflang="zh-cn" href="http://easywechat.org/docs/card.html">
    
      <link rel="alternative" hreflang="en" href="http://easywechat.org/en/docs/card.html">
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <!-- CSS -->
  <!-- build:css build/css/easywechat.css -->
  <link rel="stylesheet" href="/css/easywechat.css">
  <!-- endbuild -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="Easy We Chat">
  <!-- Open Graph -->
  <meta name="description" content="Version &amp;gt;=3.1.2  获取实例&amp;lt;?phpuse EasyWeChat\Foundation\Application;// ...$app = new Application($options);$card = $app-&amp;gt;card; API列表获取卡券颜色$card-&amp;gt;getColors(); example: $result = $card-&amp;gt;getC">
<meta property="og:type" content="website">
<meta property="og:title" content="卡券">
<meta property="og:url" content="http://easywechat.org/zh-cn/docs/card.html">
<meta property="og:site_name" content="Easy We Chat">
<meta property="og:description" content="Version &amp;gt;=3.1.2  获取实例&amp;lt;?phpuse EasyWeChat\Foundation\Application;// ...$app = new Application($options);$card = $app-&amp;gt;card; API列表获取卡券颜色$card-&amp;gt;getColors(); example: $result = $card-&amp;gt;getC">
<meta property="og:updated_time" content="2017-07-30T05:40:01.264Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="卡券">
<meta name="twitter:description" content="Version &amp;gt;=3.1.2  获取实例&amp;lt;?phpuse EasyWeChat\Foundation\Application;// ...$app = new Application($options);$card = $app-&amp;gt;card; API列表获取卡券颜色$card-&amp;gt;getColors(); example: $result = $card-&amp;gt;getC">
<meta name="twitter:site" content="anzhengchao">
  <!-- Swiftype -->
  <meta class="swiftype" name="title" data-type="string" content="卡券">
  <!-- Google Analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-64156348-1', 'auto');
  ga('send', 'pageview');
</script>


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?2ef84bd0d61ef3fd6f5626bbffe75209";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


  <meta name="baidu-site-verification" content="tBkeSW2PJg" />
  <meta name="baidu-site-verification" content="AADzpZ5myL" />
  <meta name="google-site-verification" content="Q3yeKP4X_byNBAGuf8PhwO7vNYUgo2AnJUY9uwWn8tk" />

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-2163469583563094",
    enable_page_level_ads: true
  });
</script>
</head>
<body class="">
  <div id="container">
    
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="/" id="logo">EasyWeChat</a>
    </h1>
    <nav id="main-nav">
      <ul>
        <li class="main-nav-item"><a href="/" class="main-nav-link">首页</a></li><li class="main-nav-item"><a href="/zh-cn/docs/" class="main-nav-link">文档</a></li><li class="main-nav-item"><a href="https://forum.easywechat.org" class="main-nav-link">论坛</a></li><li class="main-nav-item"><a href="https://laravist.com/series/peak-into-wechat-development-using-laravel" class="main-nav-link">视频</a></li><li class="main-nav-item"><a href="/news/" class="main-nav-link">动态</a></li><li class="main-nav-item"><a href="/donate.html" class="main-nav-link">打赏</a></li>
        <li class="main-nav-item">
          <a href="https://github.com/overtrue/wechat" class="main-nav-link">GitHub</a>
        </li>
      </ul>
    </nav>
    <div id="lang-select-wrap">
      <label id="lang-select-label"><i class="fa fa-globe"></i><span>简体中文</span></label>
      <select id="lang-select">
        
          <option data-page-lang="zh-cn" value="zh-cn" selected>简体中文</option>
        
          <option data-page-lang="zh-cn" value="en">English</option>
        
      </select>
    </div>
    
    <div id="search-btn-wrap" class="main-nav-item">
      <input type="text" class="st-default-search-input">
    </div>
    
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>
    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name">卡券</h1>
                <a href="https://github.com/EasyWeChat/docs/edit/zh-cn/card.md" class="article-edit-link" title="改进本文"><i class="fa fa-pencil"></i> 改进本文</a>
              </header>
              <!-- AD -->
              <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
              <!-- easywechat-top -->
              <ins class="adsbygoogle"
                   style="display:block"
                   data-ad-client="ca-pub-2163469583563094"
                   data-ad-slot="3400967944"
                   data-ad-format="auto"></ins>
              <script>
              (adsbygoogle = window.adsbygoogle || []).push({});
              </script>
              <!-- /AD -->
              <div>
                <strong class="sidebar-title">目录</strong>
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#获取实例"><span class="toc-text">获取实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API列表"><span class="toc-text">API列表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#获取卡券颜色"><span class="toc-text">获取卡券颜色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建卡券"><span class="toc-text">创建卡券</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建二维码"><span class="toc-text">创建二维码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ticket-换取二维码图片"><span class="toc-text">ticket 换取二维码图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ticket-换取二维码链接"><span class="toc-text">ticket 换取二维码链接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSAPI-卡券批量下发到用户"><span class="toc-text">JSAPI 卡券批量下发到用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建货架接口"><span class="toc-text">创建货架接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导入code接口"><span class="toc-text">导入code接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询导入code数目"><span class="toc-text">查询导入code数目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#核查code接口"><span class="toc-text">核查code接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图文消息群发卡券"><span class="toc-text">图文消息群发卡券</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置测试白名单"><span class="toc-text">设置测试白名单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询Code接口"><span class="toc-text">查询Code接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#核销Code接口"><span class="toc-text">核销Code接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code解码接口"><span class="toc-text">Code解码接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取用户已领取卡券接口"><span class="toc-text">获取用户已领取卡券接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看卡券详情"><span class="toc-text">查看卡券详情</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#批量查询卡列表"><span class="toc-text">批量查询卡列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更改卡券信息接口"><span class="toc-text">更改卡券信息接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置微信买单接口"><span class="toc-text">设置微信买单接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改库存接口"><span class="toc-text">修改库存接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更改Code接口"><span class="toc-text">更改Code接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除卡券接口"><span class="toc-text">删除卡券接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置卡券失效"><span class="toc-text">设置卡券失效</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#会员卡接口激活"><span class="toc-text">会员卡接口激活</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置开卡字段接口"><span class="toc-text">设置开卡字段接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#拉取会员信息接口"><span class="toc-text">拉取会员信息接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更新会员信息"><span class="toc-text">更新会员信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加子商户"><span class="toc-text">添加子商户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更新子商户"><span class="toc-text">更新子商户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#卡券开放类目查询接口"><span class="toc-text">卡券开放类目查询接口</span></a></li></ol></li></ol>
              </div>
              <div class="article-content" itemprop="articleBody" data-swiftype-index="true">
                <blockquote>
<p>Version <code>&gt;=3.1.2</code></p>
</blockquote>
<h2 id="获取实例" class="article-heading"><a href="#获取实例" class="headerlink" title="获取实例"></a>获取实例<a class="article-anchor" href="#获取实例" aria-hidden="true"></a></h2><figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">use</span> <span class="title">EasyWeChat</span>\<span class="title">Foundation</span>\<span class="title">Application</span>;</div><div class="line"></div><div class="line"><span class="comment">// ...</span></div><div class="line"></div><div class="line">$app = <span class="keyword">new</span> Application($options);</div><div class="line"></div><div class="line">$card = $app-&gt;card;</div></pre></td></tr></table></figure>
<h2 id="API列表" class="article-heading"><a href="#API列表" class="headerlink" title="API列表"></a>API列表<a class="article-anchor" href="#API列表" aria-hidden="true"></a></h2><h3 id="获取卡券颜色" class="article-heading"><a href="#获取卡券颜色" class="headerlink" title="获取卡券颜色"></a>获取卡券颜色<a class="article-anchor" href="#获取卡券颜色" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;getColors();</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$result = $card-&gt;getColors();</div></pre></td></tr></table></figure>
<h3 id="创建卡券" class="article-heading"><a href="#创建卡券" class="headerlink" title="创建卡券"></a>创建卡券<a class="article-anchor" href="#创建卡券" aria-hidden="true"></a></h3><p>创建卡券接口是微信卡券的基础接口，用于创建一类新的卡券，获取card_id，创建成功并通过审核后，商家可以通过文档提供的其他接口将卡券下发给用户，每次成功领取，库存数量相应扣除。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;create($cardType, $baseInfo, $especial);</div></pre></td></tr></table></figure>
<ul>
<li><code>cardType</code> string - 是要添加卡券的类型</li>
<li><code>baseInfo</code> array  - 为卡券的基本数据</li>
<li><code>especial</code> array  - 是扩展字段</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">	$cardType = <span class="string">'GROUPON'</span>;</div><div class="line"></div><div class="line">    $baseInfo = [</div><div class="line">        <span class="string">'logo_url'</span> =&gt; <span class="string">'http://mmbiz.qpic.cn/mmbiz/2aJY6aCPatSeibYAyy7yct9zJXL9WsNVL4JdkTbBr184gNWS6nibcA75Hia9CqxicsqjYiaw2xuxYZiaibkmORS2oovdg/0'</span>,</div><div class="line">        <span class="string">'brand_name'</span> =&gt; <span class="string">'测试商户造梦空间'</span>,</div><div class="line">        <span class="string">'code_type'</span> =&gt; <span class="string">'CODE_TYPE_QRCODE'</span>,</div><div class="line">        <span class="string">'title'</span> =&gt; <span class="string">'测试'</span>,</div><div class="line">        <span class="string">'sub_title'</span> =&gt; <span class="string">'测试副标题'</span>,</div><div class="line">        <span class="string">'color'</span> =&gt; <span class="string">'Color010'</span>,</div><div class="line">        <span class="string">'notice'</span> =&gt; <span class="string">'测试使用时请出示此券'</span>,</div><div class="line">        <span class="string">'service_phone'</span> =&gt; <span class="string">'15311931577'</span>,</div><div class="line">        <span class="string">'description'</span> =&gt; <span class="string">"测试不可与其他优惠同享\n如需团购券发票，请在消费时向商户提出\n店内均可使用，仅限堂食"</span>,</div><div class="line"></div><div class="line">        <span class="string">'date_info'</span> =&gt; [</div><div class="line">          <span class="string">'type'</span> =&gt; <span class="string">'DATE_TYPE_FIX_TERM'</span>,</div><div class="line">          <span class="string">'fixed_term'</span> =&gt; <span class="number">90</span>, <span class="comment">//表示自领取后多少天内有效，不支持填写0</span></div><div class="line">          <span class="string">'fixed_begin_term'</span> =&gt; <span class="number">0</span>, <span class="comment">//表示自领取后多少天开始生效，领取后当天生效填写0。</span></div><div class="line">        ],</div><div class="line"></div><div class="line">        <span class="string">'sku'</span> =&gt; [</div><div class="line">          <span class="string">'quantity'</span> =&gt; <span class="string">'0'</span>, <span class="comment">//自定义code时设置库存为0</span></div><div class="line">        ],</div><div class="line"></div><div class="line">        <span class="string">'location_id_list'</span> =&gt; [<span class="string">'461907340'</span>],  <span class="comment">//获取门店位置poi_id，具备线下门店的商户为必填</span></div><div class="line"></div><div class="line">        <span class="string">'get_limit'</span> =&gt; <span class="number">1</span>,</div><div class="line">        <span class="string">'use_custom_code'</span> =&gt; <span class="keyword">true</span>, <span class="comment">//自定义code时必须为true</span></div><div class="line">        <span class="string">'get_custom_code_mode'</span> =&gt; <span class="string">'GET_CUSTOM_CODE_MODE_DEPOSIT'</span>,  <span class="comment">//自定义code时设置</span></div><div class="line">        <span class="string">'bind_openid'</span> =&gt; <span class="keyword">false</span>,</div><div class="line">        <span class="string">'can_share'</span> =&gt; <span class="keyword">true</span>,</div><div class="line">        <span class="string">'can_give_friend'</span> =&gt; <span class="keyword">false</span>,</div><div class="line">        <span class="string">'center_title'</span> =&gt; <span class="string">'顶部居中按钮'</span>,</div><div class="line">        <span class="string">'center_sub_title'</span> =&gt; <span class="string">'按钮下方的wording'</span>,</div><div class="line">        <span class="string">'center_url'</span> =&gt; <span class="string">'http://www.qq.com'</span>,</div><div class="line">        <span class="string">'custom_url_name'</span> =&gt; <span class="string">'立即使用'</span>,</div><div class="line">        <span class="string">'custom_url'</span> =&gt; <span class="string">'http://www.qq.com'</span>,</div><div class="line">        <span class="string">'custom_url_sub_title'</span> =&gt; <span class="string">'6个汉字tips'</span>,</div><div class="line">        <span class="string">'promotion_url_name'</span> =&gt; <span class="string">'更多优惠'</span>,</div><div class="line">        <span class="string">'promotion_url'</span> =&gt; <span class="string">'http://www.qq.com'</span>,</div><div class="line">        <span class="string">'source'</span> =&gt; <span class="string">'造梦空间'</span>,</div><div class="line">      ];</div><div class="line"></div><div class="line">    $especial = [</div><div class="line">      <span class="string">'deal_detail'</span> =&gt; <span class="string">'deal_detail'</span>,</div><div class="line">    ];</div><div class="line"></div><div class="line">    $result = $card-&gt;create($cardType, $baseInfo, $especial);</div></pre></td></tr></table></figure>
<h3 id="创建二维码" class="article-heading"><a href="#创建二维码" class="headerlink" title="创建二维码"></a>创建二维码<a class="article-anchor" href="#创建二维码" aria-hidden="true"></a></h3><p>开发者可调用该接口生成一张卡券二维码供用户扫码后添加卡券到卡包。</p>
<p>自定义Code码的卡券调用接口时，POST数据中需指定code，非自定义code不需指定，指定openid同理。指定后的二维码只能被用户扫描领取一次。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;QRCode($cards);</div></pre></td></tr></table></figure>
<ul>
<li><code>cards</code> array - 卡券相关信息</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="comment">//领取单张卡券</span></div><div class="line">$cards = [</div><div class="line">    <span class="string">'action_name'</span> =&gt; <span class="string">'QR_CARD'</span>,</div><div class="line">    <span class="string">'expire_seconds'</span> =&gt; <span class="number">1800</span>,</div><div class="line">    <span class="string">'action_info'</span> =&gt; [</div><div class="line">      <span class="string">'card'</span> =&gt; [</div><div class="line">        <span class="string">'card_id'</span> =&gt; <span class="string">'pdkJ9uFS2WWCFfbbEfsAzrzizVyY'</span>,</div><div class="line">        <span class="string">'is_unique_code'</span> =&gt; <span class="keyword">false</span>,</div><div class="line">        <span class="string">'outer_id'</span> =&gt; <span class="number">1</span>,</div><div class="line">      ],</div><div class="line">    ],</div><div class="line">  ];</div><div class="line"></div><div class="line">$result = $card-&gt;QRCode($cards);</div></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="comment">//领取多张卡券</span></div><div class="line">$cards = [</div><div class="line">    <span class="string">'action_name'</span> =&gt; <span class="string">'QR_MULTIPLE_CARD'</span>,</div><div class="line">    <span class="string">'action_info'</span> =&gt; [</div><div class="line">      <span class="string">'multiple_card'</span> =&gt; [</div><div class="line">        <span class="string">'card_list'</span> =&gt; [</div><div class="line">          [<span class="string">'card_id'</span> =&gt; <span class="string">'pdkJ9uFS2WWCFfbbEfsAzrzizVyY'</span>],</div><div class="line">        ],</div><div class="line">      ],</div><div class="line">    ],</div><div class="line">  ];</div><div class="line"></div><div class="line">$result = $card-&gt;QRCode($cardList);</div></pre></td></tr></table></figure>
<p>请求成功返回值示例：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="keyword">array</span>(<span class="number">4</span>) &#123;</div><div class="line">  [<span class="string">"ticket"</span>]=&gt;</div><div class="line">  string(<span class="number">96</span>) <span class="string">"gQHa7joAAAAAAAAAASxodHRwOi8vd2VpeGluLnFxLmNvbS9xLzdrUFlQMHJsV3Zvanc5a2NzV1N5AAIEJUVyVwMEAKd2AA=="</span></div><div class="line">  [<span class="string">"expire_seconds"</span>]=&gt;</div><div class="line">  int(<span class="number">7776000</span>)</div><div class="line">  [<span class="string">"url"</span>]=&gt;</div><div class="line">  string(<span class="number">43</span>) <span class="string">"http://weixin.qq.com/q/7kPYP0rlWvojw9kcsWSy"</span></div><div class="line">  [<span class="string">"show_qrcode_url"</span>]=&gt;</div><div class="line">  string(<span class="number">151</span>) <span class="string">"https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=gQHa7joAAAAAAAAAASxodHRwOi8vd2VpeGluLnFxLmNvbS9xLzdrUFlQMHJsV3Zvanc5a2NzV1N5AAIEJUVyVwMEAKd2AA%3D%3D"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>成功返回值列表说明：</p>
<table>
<thead>
<tr>
<th style="text-align:center">参数名</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ticket</td>
<td style="text-align:left">获取的二维码ticket，凭借此ticket调用<a href="http://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1443433542&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">通过ticket换取二维码接口</a>可以在有效时间内换取二维码。</td>
</tr>
<tr>
<td style="text-align:center">expire_seconds</td>
<td style="text-align:left">二维码的有效时间</td>
</tr>
<tr>
<td style="text-align:center">url</td>
<td style="text-align:left">二维码图片解析后的地址，开发者可根据该地址自行生成需要的二维码图片</td>
</tr>
<tr>
<td style="text-align:center">show_qrcode_url</td>
<td style="text-align:left">二维码显示地址，点击后跳转二维码页面</td>
</tr>
</tbody>
</table>
<h3 id="ticket-换取二维码图片" class="article-heading"><a href="#ticket-换取二维码图片" class="headerlink" title="ticket 换取二维码图片"></a>ticket 换取二维码图片<a class="article-anchor" href="#ticket-换取二维码图片" aria-hidden="true"></a></h3><p>获取二维码 ticket 后，开发者可用 ticket 换取二维码图片。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;showQRCode($ticket);</div></pre></td></tr></table></figure>
<ul>
<li><code>ticket</code> string  - 获取的二维码 ticket，凭借此 ticket 可以在有效时间内换取二维码。</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$ticket = <span class="string">'gQFF8DoAAAAAAAAAASxodHRwOi8vd2VpeGluLnFxLmNvbS9xL01VTzN0T0hsS1BwUlBBYUszbVN5AAIEughxVwMEAKd2AA=='</span>;</div><div class="line">$result = $card-&gt;showQRCode($ticket);</div></pre></td></tr></table></figure>
<h3 id="ticket-换取二维码链接" class="article-heading"><a href="#ticket-换取二维码链接" class="headerlink" title="ticket 换取二维码链接"></a>ticket 换取二维码链接<a class="article-anchor" href="#ticket-换取二维码链接" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;getQRCodeUrl($ticket);  <span class="comment">//获取的二维码ticket</span></div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$ticket = <span class="string">'gQFF8DoAAAAAAAAAASxodHRwOi8vd2VpeGluLnFxLmNvbS9xL01VTzN0T0hsS1BwUlBBYUszbVN5AAIEughxVwMEAKd2AA=='</span>;</div><div class="line">$card-&gt;getQRCodeUrl($ticket);</div></pre></td></tr></table></figure>
<h3 id="JSAPI-卡券批量下发到用户" class="article-heading"><a href="#JSAPI-卡券批量下发到用户" class="headerlink" title="JSAPI 卡券批量下发到用户"></a>JSAPI 卡券批量下发到用户<a class="article-anchor" href="#JSAPI-卡券批量下发到用户" aria-hidden="true"></a></h3><p>微信卡券：JSAPI 卡券</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cards = [</div><div class="line">    [<span class="string">'card_id'</span> =&gt; <span class="string">'pdkJ9uLRSbnB3UFEjZAgUxAJrjeY'</span>, <span class="string">'outer_id'</span> =&gt; <span class="number">2</span>],</div><div class="line">    [<span class="string">'card_id'</span> =&gt; <span class="string">'pdkJ9uJ37aU-tyRj4_grs8S45k1c'</span>, <span class="string">'outer_id'</span> =&gt; <span class="number">3</span>],</div><div class="line">];</div><div class="line">$json = $card-&gt;jsConfigForAssign($cards); <span class="comment">// 返回 json 格式</span></div></pre></td></tr></table></figure>
<p>返回 json，在模板里的用法：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><div class="line">wx.addCard(&#123;</div><div class="line">    cardList: <span class="php"><span class="meta">&lt;?</span>= $json <span class="meta">?&gt;</span></span>, // 需要打开的卡券列表</div><div class="line">    success: function (res) &#123;</div><div class="line">        var cardList = res.cardList; // 添加的卡券列表信息</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="创建货架接口" class="article-heading"><a href="#创建货架接口" class="headerlink" title="创建货架接口"></a>创建货架接口<a class="article-anchor" href="#创建货架接口" aria-hidden="true"></a></h3><p>开发者需调用该接口创建货架链接，用于卡券投放。创建货架时需填写投放路径的场景字段。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;createLandingPage($banner, $pageTitle, $canShare, $scene, $cards);</div></pre></td></tr></table></figure>
<ul>
<li><code>banner</code> string -页面的 banner 图;</li>
<li><code>pageTitle</code> string - 页面的 title</li>
<li><code>canShare</code> bool - 页面是不是可以分享，true 或 false</li>
<li><code>scene</code>  string - 投放页面的场景值，具体值请参考下面的 example</li>
<li><code>cards</code>  array - 卡券列表，每个元素有两个字段</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$banner     = <span class="string">'http://mmbiz.qpic.cn/mmbiz/iaL1LJM1mF9aRKPZJkmG8xXhiaHqkKSVMMWeN3hLut7X7hicFN'</span>;</div><div class="line">$pageTitle = <span class="string">'惠城优惠大派送'</span>;</div><div class="line">$canShare  = <span class="keyword">true</span>;</div><div class="line"></div><div class="line"><span class="comment">//SCENE_NEAR_BY          附近</span></div><div class="line"><span class="comment">//SCENE_MENU             自定义菜单</span></div><div class="line"><span class="comment">//SCENE_QRCODE             二维码</span></div><div class="line"><span class="comment">//SCENE_ARTICLE             公众号文章</span></div><div class="line"><span class="comment">//SCENE_H5                 h5页面</span></div><div class="line"><span class="comment">//SCENE_IVR                 自动回复</span></div><div class="line"><span class="comment">//SCENE_CARD_CUSTOM_CELL 卡券自定义cell</span></div><div class="line">$scene = <span class="string">'SCENE_NEAR_BY'</span>;</div><div class="line"></div><div class="line">$cardList = [</div><div class="line">    [<span class="string">'card_id'</span> =&gt; <span class="string">'pdkJ9uLRSbnB3UFEjZAgUxAJrjeY'</span>, <span class="string">'thumb_url'</span> =&gt; <span class="string">'http://test.digilinx.cn/wxApi/Uploads/test.png'</span>],</div><div class="line">    [<span class="string">'card_id'</span> =&gt; <span class="string">'pdkJ9uJ37aU-tyRj4_grs8S45k1c'</span>, <span class="string">'thumb_url'</span> =&gt; <span class="string">'http://test.digilinx.cn/wxApi/Uploads/aa.jpg'</span>],</div><div class="line">];</div><div class="line"></div><div class="line">$result = $card-&gt;createLandingPage($banner, $pageTitle, $canShare, $scene, $cardList);</div></pre></td></tr></table></figure>
<h3 id="导入code接口" class="article-heading"><a href="#导入code接口" class="headerlink" title="导入code接口"></a>导入code接口<a class="article-anchor" href="#导入code接口" aria-hidden="true"></a></h3><p>在自定义code卡券成功创建并且通过审核后，必须将自定义code按照与发券方的约定数量调用导入code接口导入微信后台。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;deposit($card_id, $code);</div></pre></td></tr></table></figure>
<ul>
<li><code>cardId</code> string - 要导入code的卡券ID</li>
<li><code>code</code> string - 要导入微信卡券后台的自定义 code，最多100个</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pdkJ9uLCEF_HSKO7JdQOUcZ-PUzo'</span>;</div><div class="line">$code    = [<span class="string">'11111'</span>, <span class="string">'22222'</span>, <span class="string">'33333'</span>];</div><div class="line"></div><div class="line">$result = $card-&gt;deposit($cardId, $code);</div></pre></td></tr></table></figure>
<h3 id="查询导入code数目" class="article-heading"><a href="#查询导入code数目" class="headerlink" title="查询导入code数目"></a>查询导入code数目<a class="article-anchor" href="#查询导入code数目" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;getDepositedCount($cardId);  <span class="comment">//要导入code的卡券ID</span></div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pdkJ9uLCEF_HSKO7JdQOUcZ-PUzo'</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;getDepositedCount($cardId);</div></pre></td></tr></table></figure>
<h3 id="核查code接口" class="article-heading"><a href="#核查code接口" class="headerlink" title="核查code接口"></a>核查code接口<a class="article-anchor" href="#核查code接口" aria-hidden="true"></a></h3><p>为了避免出现导入差错，强烈建议开发者在查询完code数目的时候核查code接口校验code导入微信后台的情况。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;checkCode($cardId, $code);</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pdkJ9uLCEF_HSKO7JdQOUcZ-PUzo'</span>;</div><div class="line"></div><div class="line">$code = [<span class="string">'807732265476'</span>, <span class="string">'22222'</span>, <span class="string">'33333'</span>];</div><div class="line"></div><div class="line">$result = $card-&gt;checkCode($cardId, $code);</div></pre></td></tr></table></figure>
<h3 id="图文消息群发卡券" class="article-heading"><a href="#图文消息群发卡券" class="headerlink" title="图文消息群发卡券"></a>图文消息群发卡券<a class="article-anchor" href="#图文消息群发卡券" aria-hidden="true"></a></h3><p>特别注意：目前该接口仅支持填入非自定义code的卡券,自定义code的卡券需先进行code导入后调用。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;getHtml($cardId);</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pdkJ9uLCEF_HSKO7JdQOUcZ-PUzo'</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;getHtml($cardId);</div></pre></td></tr></table></figure>
<h3 id="设置测试白名单" class="article-heading"><a href="#设置测试白名单" class="headerlink" title="设置测试白名单"></a>设置测试白名单<a class="article-anchor" href="#设置测试白名单" aria-hidden="true"></a></h3><p>同时支持“openid”、“username”两种字段设置白名单，总数上限为10个。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;setTestWhitelist($openids); <span class="comment">// 使用 openid</span></div><div class="line">$card-&gt;setTestWhitelistByUsername($usernames); <span class="comment">// 使用 username</span></div></pre></td></tr></table></figure>
<ul>
<li><code>openids</code> array - 测试的openid列表</li>
<li><code>usernames</code> array  - 测试的微信号列表</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="comment">// by openid</span></div><div class="line">$openids   = [$openId, $openId2, $openid3...];</div><div class="line">$result = $card-&gt;setTestWhitelist($openids);</div><div class="line"></div><div class="line"><span class="comment">// by username</span></div><div class="line">$usernames = [<span class="string">'tianye0327'</span>, <span class="string">'iovertrue'</span>];</div><div class="line">$result = $card-&gt;setTestWhitelistByUsername($usernames);</div></pre></td></tr></table></figure>
<h3 id="查询Code接口" class="article-heading"><a href="#查询Code接口" class="headerlink" title="查询Code接口"></a>查询Code接口<a class="article-anchor" href="#查询Code接口" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;getCode($code, $checkConsume, $cardId);</div></pre></td></tr></table></figure>
<ul>
<li>checkConsume  是否校验code核销状态，true和false</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$code          = <span class="string">'736052543512'</span>;</div><div class="line">$checkConsume = <span class="keyword">true</span>;</div><div class="line">$cardId       = <span class="string">'pdkJ9uDgnm0pKfrTb1yV0dFMO_Gk'</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;getCode($code, $checkConsume, $cardId);</div></pre></td></tr></table></figure>
<h3 id="核销Code接口" class="article-heading"><a href="#核销Code接口" class="headerlink" title="核销Code接口"></a>核销Code接口<a class="article-anchor" href="#核销Code接口" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;consume($code);</div><div class="line"></div><div class="line"><span class="comment">// 或者指定 cardId</span></div><div class="line"></div><div class="line">$card-&gt;consume($code, $cardId);</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pdkJ9uDmhkLj6l5bm3cq9iteQBck'</span>;</div><div class="line">$code    = <span class="string">'789248558333'</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;consume($code);</div><div class="line"></div><div class="line"><span class="comment">//或</span></div><div class="line"></div><div class="line">$result = $card-&gt;consume($code, $cardId);</div></pre></td></tr></table></figure>
<h3 id="Code解码接口" class="article-heading"><a href="#Code解码接口" class="headerlink" title="Code解码接口"></a>Code解码接口<a class="article-anchor" href="#Code解码接口" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;decryptCode($encryptedCode);</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$encryptedCode = <span class="string">'XXIzTtMqCxwOaawoE91+VJdsFmv7b8g0VZIZkqf4GWA60Fzpc8ksZ/5ZZ0DVkXdE'</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;decryptCode($encryptedCode);</div></pre></td></tr></table></figure>
<h3 id="获取用户已领取卡券接口" class="article-heading"><a href="#获取用户已领取卡券接口" class="headerlink" title="获取用户已领取卡券接口"></a>获取用户已领取卡券接口<a class="article-anchor" href="#获取用户已领取卡券接口" aria-hidden="true"></a></h3><p>用于获取用户卡包里的，属于该appid下所有<strong>可用卡券，包括正常状态和未生效状态</strong>。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;getUserCards($openid, $cardId);</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$openid  = <span class="string">'odkJ9uDUz26RY-7DN1mxkznfo9xU'</span>;</div><div class="line">$cardId = <span class="string">''</span>; <span class="comment">//卡券ID。不填写时默认查询当前appid下的卡券。</span></div><div class="line"></div><div class="line">$result = $card-&gt;getUserCards($openid, $cardId);</div></pre></td></tr></table></figure>
<h3 id="查看卡券详情" class="article-heading"><a href="#查看卡券详情" class="headerlink" title="查看卡券详情"></a>查看卡券详情<a class="article-anchor" href="#查看卡券详情" aria-hidden="true"></a></h3><p>开发者可以调用该接口查询某个card_id的创建信息、审核状态以及库存数量。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;getCard($cardId);</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pdkJ9uLRSbnB3UFEjZAgUxAJrjeY'</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;getCard($cardId);</div></pre></td></tr></table></figure>
<h3 id="批量查询卡列表" class="article-heading"><a href="#批量查询卡列表" class="headerlink" title="批量查询卡列表"></a>批量查询卡列表<a class="article-anchor" href="#批量查询卡列表" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;lists($offset, $count, $statusList);</div></pre></td></tr></table></figure>
<ul>
<li><code>offset</code> int - 查询卡列表的起始偏移量，从0开始</li>
<li><code>count</code> int - 需要查询的卡片的数量</li>
<li><code>statusList</code> -  支持开发者拉出指定状态的卡券列表，详见example</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$offset      = <span class="number">0</span>;</div><div class="line">$count       = <span class="number">10</span>;</div><div class="line"></div><div class="line"><span class="comment">//CARD_STATUS_NOT_VERIFY,待审核；</span></div><div class="line"><span class="comment">//CARD_STATUS_VERIFY_FAIL,审核失败；</span></div><div class="line"><span class="comment">//CARD_STATUS_VERIFY_OK，通过审核；</span></div><div class="line"><span class="comment">//CARD_STATUS_USER_DELETE，卡券被商户删除；</span></div><div class="line"><span class="comment">//CARD_STATUS_DISPATCH，在公众平台投放过的卡券；</span></div><div class="line">$statusList = <span class="string">'CARD_STATUS_VERIFY_OK'</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;lists($offset, $count, $statusList);</div></pre></td></tr></table></figure>
<h3 id="更改卡券信息接口" class="article-heading"><a href="#更改卡券信息接口" class="headerlink" title="更改卡券信息接口"></a>更改卡券信息接口<a class="article-anchor" href="#更改卡券信息接口" aria-hidden="true"></a></h3><p>支持更新所有卡券类型的部分通用字段及特殊卡券中特定字段的信息。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;update($cardId, $type, $baseInfo);</div></pre></td></tr></table></figure>
<ul>
<li><code>type</code> string - 卡券类型</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pdkJ9uCzKWebwgNjxosee0ZuO3Os'</span>;</div><div class="line"></div><div class="line">$type = <span class="string">'groupon'</span>;</div><div class="line"></div><div class="line">$baseInfo = [</div><div class="line">    <span class="string">'logo_url'</span> =&gt; <span class="string">'http://mmbiz.qpic.cn/mmbiz/2aJY6aCPatSeibYAyy7yct9zJXL9WsNVL4JdkTbBr184gNWS6nibcA75Hia9CqxicsqjYiaw2xuxYZiaibkmORS2oovdg/0'</span>,</div><div class="line">    <span class="string">'center_title'</span> =&gt; <span class="string">'顶部居中按钮'</span>,</div><div class="line">    <span class="string">'center_sub_title'</span> =&gt; <span class="string">'按钮下方的wording'</span>,</div><div class="line">    <span class="string">'center_url'</span> =&gt; <span class="string">'http://www.baidu.com'</span>,</div><div class="line">    <span class="string">'custom_url_name'</span> =&gt; <span class="string">'立即使用'</span>,</div><div class="line">    <span class="string">'custom_url'</span> =&gt; <span class="string">'http://www.qq.com'</span>,</div><div class="line">    <span class="string">'custom_url_sub_title'</span> =&gt; <span class="string">'6个汉字tips'</span>,</div><div class="line">    <span class="string">'promotion_url_name'</span> =&gt; <span class="string">'更多优惠'</span>,</div><div class="line">    <span class="string">'promotion_url'</span> =&gt; <span class="string">'http://www.qq.com'</span>,</div><div class="line">];</div><div class="line"></div><div class="line">$result = $card-&gt;update($cardId, $type, $baseInfo);</div></pre></td></tr></table></figure>
<h3 id="设置微信买单接口" class="article-heading"><a href="#设置微信买单接口" class="headerlink" title="设置微信买单接口"></a>设置微信买单接口<a class="article-anchor" href="#设置微信买单接口" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;setPayCell($cardId, $isOpen);</div></pre></td></tr></table></figure>
<ul>
<li><code>isOpen</code> string - 是否开启买单功能，填 true/false，不填默认 true</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pdkJ9uH7u11R-Tu1kilbaW_zDFow'</span>;</div><div class="line">$isOpen = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;setPayCell($cardId, $isOpen);</div></pre></td></tr></table></figure>
<h3 id="修改库存接口" class="article-heading"><a href="#修改库存接口" class="headerlink" title="修改库存接口"></a>修改库存接口<a class="article-anchor" href="#修改库存接口" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;increaseStock($cardId, $amount); <span class="comment">// 增加库存</span></div><div class="line">$card-&gt;reduceStock($cardId, $amount); <span class="comment">// 减少库存</span></div></pre></td></tr></table></figure>
<ul>
<li><code>cardId</code> string - 卡券 ID</li>
<li><code>amount</code> int - 修改多少库存</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pdkJ9uLRSbnB3UFEjZAgUxAJrjeY'</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;increaseStock($cardId, <span class="number">100</span>);</div></pre></td></tr></table></figure>
<h3 id="更改Code接口" class="article-heading"><a href="#更改Code接口" class="headerlink" title="更改Code接口"></a>更改Code接口<a class="article-anchor" href="#更改Code接口" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;updateCode($code, $newCode, $cardId);</div></pre></td></tr></table></figure>
<ul>
<li><code>newCode</code> string - 变更后的有效Code码</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$code     = <span class="string">'148246271394'</span>;</div><div class="line">$newCode = <span class="string">'659266965266'</span>;</div><div class="line">$cardId  = <span class="string">''</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;updateCode($code, $newCode, $cardId);</div></pre></td></tr></table></figure>
<h3 id="删除卡券接口" class="article-heading"><a href="#删除卡券接口" class="headerlink" title="删除卡券接口"></a>删除卡券接口<a class="article-anchor" href="#删除卡券接口" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;delete($cardId);</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pdkJ9uItT7iUpBp4GjZp8Cae0Vig'</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;delete($cardId);</div></pre></td></tr></table></figure>
<h3 id="设置卡券失效" class="article-heading"><a href="#设置卡券失效" class="headerlink" title="设置卡券失效"></a>设置卡券失效<a class="article-anchor" href="#设置卡券失效" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;disable($code, $cardId);</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$code    = <span class="string">'736052543512'</span>;</div><div class="line">$cardId = <span class="string">''</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;disable($code, $cardId);</div></pre></td></tr></table></figure>
<h3 id="会员卡接口激活" class="article-heading"><a href="#会员卡接口激活" class="headerlink" title="会员卡接口激活"></a>会员卡接口激活<a class="article-anchor" href="#会员卡接口激活" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$result = $card-&gt;activate($info);</div></pre></td></tr></table></figure>
<ul>
<li><code>info</code> - 需要激活的会员卡信息</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$activate = [</div><div class="line">      <span class="string">'membership_number'</span>        =&gt; <span class="string">'357898858'</span>, <span class="comment">//会员卡编号，由开发者填入，作为序列号显示在用户的卡包里。可与Code码保持等值。</span></div><div class="line">      <span class="string">'code'</span>                     =&gt; <span class="string">'916679873278'</span>, <span class="comment">//创建会员卡时获取的初始code。</span></div><div class="line">      <span class="string">'activate_begin_time'</span>      =&gt; <span class="string">'1397577600'</span>, <span class="comment">//激活后的有效起始时间。若不填写默认以创建时的 data_info 为准。Unix时间戳格式</span></div><div class="line">      <span class="string">'activate_end_time'</span>        =&gt; <span class="string">'1422724261'</span>, <span class="comment">//激活后的有效截至时间。若不填写默认以创建时的 data_info 为准。Unix时间戳格式。</span></div><div class="line">      <span class="string">'init_bonus'</span>               =&gt; <span class="string">'持白金会员卡到店消费，可享8折优惠。'</span>, <span class="comment">//初始积分，不填为0。</span></div><div class="line">      <span class="string">'init_balance'</span>             =&gt; <span class="string">'持白金会员卡到店消费，可享8折优惠。'</span>, <span class="comment">//初始余额，不填为0。</span></div><div class="line">      <span class="string">'init_custom_field_value1'</span> =&gt; <span class="string">'白银'</span>, <span class="comment">//创建时字段custom_field1定义类型的初始值，限制为4个汉字，12字节。</span></div><div class="line">      <span class="string">'init_custom_field_value2'</span> =&gt; <span class="string">'9折'</span>, <span class="comment">//创建时字段custom_field2定义类型的初始值，限制为4个汉字，12字节。</span></div><div class="line">      <span class="string">'init_custom_field_value3'</span> =&gt; <span class="string">'200'</span>, <span class="comment">//创建时字段custom_field3定义类型的初始值，限制为4个汉字，12字节。</span></div><div class="line">];</div><div class="line"></div><div class="line">$result = $card-&gt;activate($activate);</div></pre></td></tr></table></figure>
<h3 id="设置开卡字段接口" class="article-heading"><a href="#设置开卡字段接口" class="headerlink" title="设置开卡字段接口"></a>设置开卡字段接口<a class="article-anchor" href="#设置开卡字段接口" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;activateUserForm($cardId, $requiredForm, $optionalForm);</div></pre></td></tr></table></figure>
<ul>
<li><code>requiredForm</code> array - 会员卡激活时的必填选项</li>
<li><code>optionalForm</code> array - 会员卡激活时的选填项</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pdkJ9uJYAyfLXsUCwI2LdH2Pn1AU'</span>;</div><div class="line"></div><div class="line">$requiredForm = [</div><div class="line">    <span class="string">'required_form'</span> =&gt; [</div><div class="line">        <span class="string">'common_field_id_list'</span> =&gt; [</div><div class="line">            <span class="string">'USER_FORM_INFO_FLAG_MOBILE'</span>,</div><div class="line">            <span class="string">'USER_FORM_INFO_FLAG_LOCATION'</span>,</div><div class="line">            <span class="string">'USER_FORM_INFO_FLAG_BIRTHDAY'</span>,</div><div class="line">        ],</div><div class="line">        <span class="string">'custom_field_list'</span> =&gt; [</div><div class="line">            <span class="string">'喜欢的食物'</span>,</div><div class="line">        ],</div><div class="line">    ],</div><div class="line">];</div><div class="line"></div><div class="line">$optionalForm = [</div><div class="line">    <span class="string">'optional_form'</span> =&gt; [</div><div class="line">        <span class="string">'common_field_id_list'</span> =&gt; [</div><div class="line">            <span class="string">'USER_FORM_INFO_FLAG_EMAIL'</span>,</div><div class="line">        ],</div><div class="line">        <span class="string">'custom_field_list'</span> =&gt; [</div><div class="line">            <span class="string">'喜欢的食物'</span>,</div><div class="line">        ],</div><div class="line">    ],</div><div class="line">];</div><div class="line"></div><div class="line">$result = $card-&gt;activateUserForm($cardId, $requiredForm, $optionalForm);</div></pre></td></tr></table></figure>
<h3 id="拉取会员信息接口" class="article-heading"><a href="#拉取会员信息接口" class="headerlink" title="拉取会员信息接口"></a>拉取会员信息接口<a class="article-anchor" href="#拉取会员信息接口" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;getMemberCardUser($cardId, $code);</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$cardId = <span class="string">'pbLatjtZ7v1BG_ZnTjbW85GYc_E8'</span>;</div><div class="line">$code    = <span class="string">'916679873278'</span>;</div><div class="line"></div><div class="line">$result = $card-&gt;getMemberCardUser($cardId, $code);</div></pre></td></tr></table></figure>
<h3 id="更新会员信息" class="article-heading"><a href="#更新会员信息" class="headerlink" title="更新会员信息"></a>更新会员信息<a class="article-anchor" href="#更新会员信息" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;updateMemberCardUser($updateUser);</div></pre></td></tr></table></figure>
<ul>
<li><code>updateUser</code> array - 可以更新的会员信息</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$updateUser = [</div><div class="line">    <span class="string">'code'</span>                =&gt; <span class="string">'916679873278'</span>, <span class="comment">//卡券Code码。</span></div><div class="line">    <span class="string">'card_id'</span>             =&gt; <span class="string">'pbLatjtZ7v1BG_ZnTjbW85GYc_E8'</span>, <span class="comment">//卡券ID。</span></div><div class="line">    <span class="string">'record_bonus'</span>        =&gt; <span class="string">'消费30元，获得3积分'</span>, <span class="comment">//商家自定义积分消耗记录，不超过14个汉字。</span></div><div class="line">    <span class="string">'bonus'</span>               =&gt; <span class="string">'100'</span>, <span class="comment">//需要设置的积分全量值，传入的数值会直接显示，如果同时传入add_bonus和bonus,则前者无效。</span></div><div class="line">    <span class="string">'balance'</span>             =&gt; <span class="string">'持白金会员卡到店消费，可享8折优惠。'</span>, <span class="comment">//需要设置的余额全量值，传入的数值会直接显示，如果同时传入add_balance和balance,则前者无效。</span></div><div class="line">    <span class="string">'record_balance'</span>      =&gt; <span class="string">'持白金会员卡到店消费，可享8折优惠。'</span>, <span class="comment">//商家自定义金额消耗记录，不超过14个汉字。</span></div><div class="line">    <span class="string">'custom_field_value1'</span> =&gt; <span class="string">'100'</span>, <span class="comment">//创建时字段custom_field1定义类型的最新数值，限制为4个汉字，12字节。</span></div><div class="line">    <span class="string">'custom_field_value2'</span> =&gt; <span class="string">'200'</span>, <span class="comment">//创建时字段custom_field2定义类型的最新数值，限制为4个汉字，12字节。</span></div><div class="line">    <span class="string">'custom_field_value3'</span> =&gt; <span class="string">'300'</span>, <span class="comment">//创建时字段custom_field3定义类型的最新数值，限制为4个汉字，12字节。</span></div><div class="line">];</div><div class="line"></div><div class="line">$result = $card-&gt;updateMemberCardUser($updateUser);</div></pre></td></tr></table></figure>
<h3 id="添加子商户" class="article-heading"><a href="#添加子商户" class="headerlink" title="添加子商户"></a>添加子商户<a class="article-anchor" href="#添加子商户" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;craeteSubMerchant($brandName, $logoUrl, $protocol, $endTime, $primaryCategoryId, $secondaryCategoryId, $agreementMediaId, $operatorMediaId, $appId);</div></pre></td></tr></table></figure>
<ul>
<li><code>brand_name</code> string - 子商户名称（12个汉字内），该名称将在制券时填入并显示在卡券页面上</li>
<li><code>logo_url</code>  string - 子商户 logo，可通过上传 logo 接口获取。该 logo 将在制券时填入并显示在卡券页面上</li>
<li><code>protocol</code>  string - 授权函ID，即通过上传临时素材接口上传授权函后获得的 meida_id</li>
<li><code>primary_category_id</code>  int - 一级类目id,可以通过本文档中接口查询</li>
<li><code>secondary_category_id</code> int - 二级类目id，可以通过本文档中接口查询</li>
<li><code>agreement_media_id</code>  string - 营业执照或个体工商户营业执照彩照或扫描件</li>
<li><code>operator_media_id</code>  string - 营业执照内登记的经营者身份证彩照或扫描件</li>
<li><code>app_id</code>  string - 子商户的公众号 app_id，配置后子商户卡券券面上的 app_id 为该 app_id, app_id 须经过认证</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$info = [</div><div class="line">    <span class="string">'brand_name'</span> =&gt; <span class="string">'overtrue'</span>,</div><div class="line">    <span class="string">'logo_url'</span> =&gt; <span class="string">'http://mmbiz.qpic.cn/mmbiz/iaL1LJM1mF9aRKPZJkmG8xXhiaHqkKSVMMWeN3hLut7X7hicFNjakmxibMLGWpXrEXB33367o7zHN0CwngnQY7zb7g/0'</span>,</div><div class="line">    <span class="string">'protocol'</span> =&gt; <span class="string">'qIqwTfzAdJ_1-VJFT0fIV53DSY4sZY2WyhkzZzbV498Qgdp-K5HJtZihbHLS0Ys0'</span>,</div><div class="line">    <span class="string">'end_time'</span> =&gt; <span class="string">'1438990559'</span>,</div><div class="line">    <span class="string">'primary_category_id'</span> =&gt; <span class="number">1</span>,</div><div class="line">    <span class="string">'secondary_category_id'</span> =&gt; <span class="number">101</span>,</div><div class="line">    <span class="string">'agreement_media_id'</span> =&gt; <span class="string">''</span>,</div><div class="line">    <span class="string">'operator_media_id'</span> =&gt; <span class="string">''</span>,</div><div class="line">    <span class="string">'app_id'</span> =&gt; <span class="string">''</span>,</div><div class="line">];</div><div class="line"></div><div class="line">$result = $card-&gt;createSubMerchant($info);</div></pre></td></tr></table></figure>
<h3 id="更新子商户" class="article-heading"><a href="#更新子商户" class="headerlink" title="更新子商户"></a>更新子商户<a class="article-anchor" href="#更新子商户" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;updateSubMerchant($merchantId, $info);</div></pre></td></tr></table></figure>
<ul>
<li><code>$merchantId</code> int - 子商户 ID</li>
<li><code>$info</code> array - 参数与创建子商户参数一样</li>
</ul>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$info = [</div><div class="line">  <span class="comment">//...</span></div><div class="line">];</div><div class="line">$result = $card-&gt;updateSubMerchant(<span class="string">'12'</span>, $info);</div></pre></td></tr></table></figure>
<h3 id="卡券开放类目查询接口" class="article-heading"><a href="#卡券开放类目查询接口" class="headerlink" title="卡券开放类目查询接口"></a>卡券开放类目查询接口<a class="article-anchor" href="#卡券开放类目查询接口" aria-hidden="true"></a></h3><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$card-&gt;getCategories();</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line">$result = $card-&gt;getCategories();</div></pre></td></tr></table></figure>
<p>关于卡券接口的使用请参阅官方文档：<a href="http://mp.weixin.qq.com/wiki/" target="_blank" rel="external">http://mp.weixin.qq.com/wiki/</a></p>


                <div class="donate-btn text-center"><a href="/donate.html" target="_blank">我要打赏支持</a></div>
              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2017-07-30T05:40:01.264Z" itemprop="dateModified">上次更新：2017-07-30</time>
                <a href="lucky-money.html" class="article-footer-prev" title="红包"><i class="fa fa-chevron-left"></i><span>上一页</span></a><a href="store.html" class="article-footer-next" title="小店"><span>下一页</span><i class="fa fa-chevron-right"></i></a>
              </footer>
              
            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <!-- AD -->
            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <!-- easywechat-sidebar -->
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-2163469583563094"
                 data-ad-slot="6354434345"
                 data-ad-format="auto"></ins>
            <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
            <!-- /AD -->
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner"><strong class="sidebar-title">开始使用</strong><a href="index.html" class="sidebar-link">概述</a><a href="installation.html" class="sidebar-link">安装</a><a href="tutorial.html" class="sidebar-link">小教程</a><a href="configuration.html" class="sidebar-link">配置</a><a href="integration.html" class="sidebar-link">在框架中使用</a><a href="troubleshooting.html" class="sidebar-link">常见问题汇总</a><strong class="sidebar-title">基本使用</strong><a href="server.html" class="sidebar-link">服务端</a><a href="messages.html" class="sidebar-link">消息</a><a href="message-transfer.html" class="sidebar-link">多客服消息转发</a><a href="events.html" class="sidebar-link">事件</a><a href="broadcast.html" class="sidebar-link">群发消息</a><a href="notice.html" class="sidebar-link">模板消息</a><a href="user.html" class="sidebar-link">用户</a><a href="user-tag.html" class="sidebar-link">用户标签</a><a href="user-group.html" class="sidebar-link">用户组</a><a href="oauth.html" class="sidebar-link">网页授权</a><a href="mini_program.html" class="sidebar-link">小程序</a><a href="material.html" class="sidebar-link">素材管理</a><a href="menu.html" class="sidebar-link">菜单</a><a href="js.html" class="sidebar-link">JSSDK</a><a href="payment.html" class="sidebar-link">支付</a><a href="merchant_payment.html" class="sidebar-link">企业支付</a><a href="lucky-money.html" class="sidebar-link">红包</a><a href="card.html" class="sidebar-link current">卡券</a><a href="store.html" class="sidebar-link">小店</a><a href="poi.html" class="sidebar-link">门店</a><a href="staff.html" class="sidebar-link">客服</a><a href="anaylsis.html" class="sidebar-link">数据统计与分析</a><a href="qrcode.html" class="sidebar-link">二维码</a><a href="short-url.html" class="sidebar-link">短网址</a><a href="semantic.html" class="sidebar-link">语义理解</a><a href="reply.html" class="sidebar-link">自动回复</a><a href="open_platform.html" class="sidebar-link">开放平台</a><strong class="sidebar-title">自定义</strong><a href="access_token.html" class="sidebar-link">Access Token</a><a href="cache.html" class="sidebar-link">缓存</a><strong class="sidebar-title">其他</strong><a href="troubleshooting.html" class="sidebar-link">问题解答</a><a href="contributing.html" class="sidebar-link">贡献</a><a href="releases.html" class="sidebar-link">更新日志</a><a href="roadmap.html" class="sidebar-link">路线图</a></div>
</aside>
    </div>
  </div>
</div>
  </div>
  <footer id="footer">
  <div class="wrapper">
    <div class="inner">
      <div class="friend-links">
        
        <a href="http://overtrue.me" target="_blank">overtrue.me</a>
        
        <a href="https://laravel-china.org" target="_blank">Laravel China</a>
        
        <a href="https://laravist.com" target="_blank">Laravist 视频教程</a>
        
        <a href="http://laravelacademy.org" target="_blank">Laravel 学院</a>
        
      </div>
      <div id="footer-copyright">
        &copy; 2017 <a href="http://overtrue.me/" target="_blank">overtrue</a><br>
        Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.
      </div>
      <div id="footer-links">
        <a href="http://weibo.com/44294631" class="footer-link" target="_blank"><i class="fa fa-weibo"></i></a>
        <a href="https://github.com/overtrue/wechat" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
        <a href="https://twitter.com/anzhengchao" class="footer-link" target="_blank"><i class="fa fa-twitter"></i></a>
      </div>
    </div>
  </div>
</footer>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <li class="mobile-nav-item"><a href="/" class="mobile-nav-link">首页</a></li><li class="mobile-nav-item"><a href="/zh-cn/docs/" class="mobile-nav-link">文档</a></li><li class="mobile-nav-item"><a href="https://forum.easywechat.org" class="mobile-nav-link">论坛</a></li><li class="mobile-nav-item"><a href="https://laravist.com/series/peak-into-wechat-development-using-laravel" class="mobile-nav-link">视频</a></li><li class="mobile-nav-item"><a href="/news/" class="mobile-nav-link">动态</a></li><li class="mobile-nav-item"><a href="/donate.html" class="mobile-nav-link">打赏</a></li>
      <li class="mobile-nav-item">
        <a href="https://github.com/overtrue/wechat" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">开始使用</strong><a href="index.html" class="mobile-nav-link">概述</a><a href="installation.html" class="mobile-nav-link">安装</a><a href="tutorial.html" class="mobile-nav-link">小教程</a><a href="configuration.html" class="mobile-nav-link">配置</a><a href="integration.html" class="mobile-nav-link">在框架中使用</a><a href="troubleshooting.html" class="mobile-nav-link">常见问题汇总</a><strong class="mobile-nav-title">基本使用</strong><a href="server.html" class="mobile-nav-link">服务端</a><a href="messages.html" class="mobile-nav-link">消息</a><a href="message-transfer.html" class="mobile-nav-link">多客服消息转发</a><a href="events.html" class="mobile-nav-link">事件</a><a href="broadcast.html" class="mobile-nav-link">群发消息</a><a href="notice.html" class="mobile-nav-link">模板消息</a><a href="user.html" class="mobile-nav-link">用户</a><a href="user-tag.html" class="mobile-nav-link">用户标签</a><a href="user-group.html" class="mobile-nav-link">用户组</a><a href="oauth.html" class="mobile-nav-link">网页授权</a><a href="mini_program.html" class="mobile-nav-link">小程序</a><a href="material.html" class="mobile-nav-link">素材管理</a><a href="menu.html" class="mobile-nav-link">菜单</a><a href="js.html" class="mobile-nav-link">JSSDK</a><a href="payment.html" class="mobile-nav-link">支付</a><a href="merchant_payment.html" class="mobile-nav-link">企业支付</a><a href="lucky-money.html" class="mobile-nav-link">红包</a><a href="card.html" class="mobile-nav-link current">卡券</a><a href="store.html" class="mobile-nav-link">小店</a><a href="poi.html" class="mobile-nav-link">门店</a><a href="staff.html" class="mobile-nav-link">客服</a><a href="anaylsis.html" class="mobile-nav-link">数据统计与分析</a><a href="qrcode.html" class="mobile-nav-link">二维码</a><a href="short-url.html" class="mobile-nav-link">短网址</a><a href="semantic.html" class="mobile-nav-link">语义理解</a><a href="reply.html" class="mobile-nav-link">自动回复</a><a href="open_platform.html" class="mobile-nav-link">开放平台</a><strong class="mobile-nav-title">自定义</strong><a href="access_token.html" class="mobile-nav-link">Access Token</a><a href="cache.html" class="mobile-nav-link">缓存</a><strong class="mobile-nav-title">其他</strong><a href="troubleshooting.html" class="mobile-nav-link">问题解答</a><a href="contributing.html" class="mobile-nav-link">贡献</a><a href="releases.html" class="mobile-nav-link">更新日志</a><a href="roadmap.html" class="mobile-nav-link">路线图</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>简体中文</span></span>
    <select id="mobile-lang-select">
      
        <option value="zh-cn" selected>简体中文</option>
      
        <option value="en">English</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->
<script src="/js/lang_select.js"></script>
<script src="/js/toc.js"></script>
<script src="/js/mobile_nav.js"></script>
<!-- endbuild -->
<script src="//cdn.jsdelivr.net/retinajs/1.1.0/retina.min.js" async></script>

<script src="/js/tab.js"></script>
<!-- Swiftype -->
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','URYXMYgtQuEhNHNY8d-F','2.0.0');
</script>
</body>
</html>